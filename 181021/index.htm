
<html>
	<head>
<title>title</title>
<style>
body{
}
</style>

<script>
document.addEventListener("DOMContentLoaded", function(event) { 
  console.log( 'DOMContentLoaded' );
  var jsElm = document.createElement("script");
  jsElm.type = "application/javascript";
  jsElm.src = 'https://code.jquery.com/jquery-3.3.1.min.js';
  jsElm.onload = function(e){
    console.log('jsElm.onload');
	//id01.insertAdjacentHTML('afterbegin', 'jquery讀取成功');
	poi();
  };
  //document.body.appendChild(jsElm);
  document.head.appendChild(jsElm);
});




function poi0(){}
function poi_getjs(){
  $.getScript("https://platform.twitter.com/widgets.js").done(function(){
    if(0){
      var id01=document.getElementById('ppp');
      //var id01=document.getElementsByTagName("pre")[0];
      id01.insertAdjacentHTML('beforebegin', 'beforebegin');
      id01.insertAdjacentHTML('afterbegin', 'afterbegin');
      id01.insertAdjacentHTML('beforeend', 'beforeend');
      id01.insertAdjacentHTML('afterend', 'afterend');
      console.log( id01.outerHTML );
    }else{
      //$("pre").hide();
	  $("pre").html("完成");
    }
    //


  });
}
function poi_ajax(){
  $(document).ajaxComplete(function() {
    //console.log( 'ajaxComplete' );
  });
  $(document).ajaxStop(function() {
    console.log( 'ajaxStop' );
  });
}
function poi3(qq,pp){
  var url=''+qq[pp];
  var jqxhr =$.ajax({
    type:     "GET",
    url:      "https://publish.twitter.com/oembed?url="+url,
    dataType: "jsonp",
    success: function(data){
      $("#ddd").append( $(data.html)[0] );
    },
    complete:function(data){
      //console.log( pp,qq.length,qq[pp] );
      if(pp<(qq.length-1)){
        pp++;
        poi3(qq,pp);
      }else{
        poi_getjs();
      }
    },
  });
  jqxhr.done(function(a,b,c){
    //console.log( a,b,c );
    //console.log( pp,qq.length,qq[pp] );
	$("pre").html("<b>("+pp+"/"+qq.length+") "+b+" "+qq[pp]+"</b>");
    //console.log( 'jqxhr.done' );
  });
  jqxhr.fail(function(a,b,c){
	$("pre").html("<b>("+pp+"/"+qq.length+") 錯誤</b>");
    console.log( a,b,c );
  	throw "錯誤error";
	//throw new Error("錯誤error");
  });
  
}
function poi2(){
  var qq=$("pre").text();
  $("pre").html("<b>讀取測試</b>");
  qq=qq.split("\n");
  qq=qq.filter(Boolean);
  //console.log( qq );
  for(i=0;i<qq.length;i++){
    //$("#ddd").append(i+" "+qq[i]+"<br/>");
    //poi( qq[i] );
  }
  poi3(qq,0);


}
function poi(){

try{
  $(document).ready(function() {
  	console.log('document.ready');
    time = new Date();
	//
    poi_ajax();
	//poi();
    poi2();
  });
}catch(err){
  	console.log( ''+err.message );
}finally{
    console.log( 'try-catch-finally' );
}

}
</script>

	</head>
	<body>
	
<pre id="ppp">
https://twitter.com/kantoku_5th/status/1054291759570677760


https://twitter.com/niiiitoooon/status/1054177577122750464
https://twitter.com/konnyak86392863/status/1053828713748418562
https://twitter.com/asnaronna/status/1054073950966140928

https://twitter.com/nakaharu_wo/status/1054012612298461185

https://twitter.com/mamgon/status/744688619588247556
https://twitter.com/yukinkzk/status/1054282195232149505

https://twitter.com/toyama572/status/1053936784785043460

https://twitter.com/aju00_dyd/status/1053985932892762112
https://twitter.com/rurudo_/status/1053269145662382080
https://twitter.com/atikix/status/1050305390846439424

https://twitter.com/mono_0157_/status/1053652501554061312
https://twitter.com/nanananananasea/status/1053587305649266688
https://twitter.com/kakaobataaaaaaa/status/1054000805903101952
https://twitter.com/twdshamano/status/1053979236870979584
https://twitter.com/totakeke___/status/1053958486315286528
https://twitter.com/habarag/status/1053840885505437696
https://twitter.com/nonco331/status/1053993720217927680

https://twitter.com/kanihamiso/status/1053857732841811968
https://twitter.com/ebihurya332/status/1053811926659035136

https://twitter.com/shiratamacaron/status/1053990681121718272
https://twitter.com/mi_me_i/status/1054023462702862338
https://twitter.com/mery__S2_/status/1053971598892355584
https://twitter.com/Spawnfoxy/status/1053925147319590912
https://twitter.com/atu_okenay/status/1054025365528567808
https://twitter.com/imigimuru/status/1054023781583269893

</pre>

<div id="ddd"></div>


	</body>
</html>
